---

title: Benchmarks


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/06_other/306_benchmarks.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_other/306_benchmarks.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Julia-vs-NumPy-Performance">Julia vs NumPy Performance<a class="anchor-link" href="#Julia-vs-NumPy-Performance"> </a></h2><ul>
<li>Extended from: <a href="https://github.com/kbarbary/website/blob/master/posts/julia-vs-numpy-arrays.rst">https://github.com/kbarbary/website/blob/master/posts/julia-vs-numpy-arrays.rst</a></li>
<li>tl;dr: NumPy still faster for now</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Element-wise-Multiply">Element-wise Multiply<a class="anchor-link" href="#Element-wise-Multiply"> </a></h3><ul>
<li>Faster on NumPy by a 1.3-1.5x for large N</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Python-3.8.8,-NumPy-1.19.2">Python 3.8.8, NumPy 1.19.2<a class="anchor-link" href="#Python-3.8.8,-NumPy-1.19.2"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">macro</span> <span class="n">python_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="nb">open</span><span class="p">(</span><span class="n">PYTHON_PATH</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">stdout</span><span class="p">)</span> <span class="n">do</span> <span class="n">io</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="n">end</span><span class="p">;</span> <span class="n">end</span><span class="p">;</span>

<span class="n">python</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">from IPython.utils import io</span>
<span class="s2">from numpy.random import rand</span>

<span class="s2">for n in [10**k for k in range(9)]:</span>
<span class="s2">    x = rand(n)</span>
<span class="s2">    y = rand(n)</span>
<span class="s2">    with io.capture_output():</span>
<span class="s2">        time = %timeit -o (x*y).sum()</span>
<span class="s2">    print(f&#39;n = </span><span class="si">{n:&gt;12,}</span><span class="s2">: time=</span><span class="si">{time}</span><span class="s2">&#39;)</span>

<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Python 3.8.8 (default, Feb 24 2021, 21:46:12) 
Type &#39;copyright&#39;, &#39;credits&#39; or &#39;license&#39; for more information
IPython 7.22.0 -- An enhanced Interactive Python. Type &#39;?&#39; for help.

In [1]: 
In [2]: 
In [3]: 
In [3]:    ...:    ...:    ...:    ...:    ...:    ...: n =            1: time=2.34 µs ± 23.2 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =           10: time=2.36 µs ± 27.8 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =          100: time=2.41 µs ± 46.1 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =        1,000: time=3.03 µs ± 10.5 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =       10,000: time=6.92 µs ± 50.8 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =      100,000: time=47.5 µs ± 127 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
n =    1,000,000: time=1.05 ms ± 9.72 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
n =   10,000,000: time=16.2 ms ± 1.15 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)
n =  100,000,000: time=151 ms ± 872 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)

In [4]: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Julia-1.6">Julia 1.6<a class="anchor-link" href="#Julia-1.6"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">using</span> <span class="n">BenchmarkTools</span>
<span class="n">using</span> <span class="n">Strs</span>

<span class="n">pr</span><span class="s2">&quot;&quot;&quot;\</span><span class="si">%10s</span><span class="s2">(&quot;n&quot;) \</span><span class="si">%10s</span><span class="s2">(&quot;result&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="mi">10</span> <span class="o">.^</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">pr</span><span class="s2">&quot;\</span><span class="si">%10s</span><span class="s2">(n)&quot;</span>
    <span class="nd">@btime</span> <span class="nb">sum</span><span class="p">(</span><span class="err">$</span><span class="n">x</span> <span class="o">.*</span> <span class="err">$</span><span class="n">y</span><span class="p">);</span>
<span class="n">end</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>         n     result
         1  25.590 ns (1 allocation: 96 bytes)
        10  35.727 ns (1 allocation: 160 bytes)
       100  56.584 ns (1 allocation: 896 bytes)
      1000  625.689 ns (1 allocation: 7.94 KiB)
     10000  6.244 μs (2 allocations: 78.20 KiB)
    100000  64.332 μs (2 allocations: 781.33 KiB)
   1000000  1.181 ms (2 allocations: 7.63 MiB)
  10000000  23.123 ms (2 allocations: 76.29 MiB)
 100000000  219.613 ms (2 allocations: 762.94 MiB)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Matrix-Multiply">Matrix Multiply<a class="anchor-link" href="#Matrix-Multiply"> </a></h3><ul>
<li>Julia is a bit faster, but realistically negligible difference.</li>
<li>Both NumPy and Julia are probably using BLAS under the hood.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Python-3.8.8,-NumPy-1.19.2">Python 3.8.8, NumPy 1.19.2<a class="anchor-link" href="#Python-3.8.8,-NumPy-1.19.2"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">macro</span> <span class="n">python_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="nb">open</span><span class="p">(</span><span class="n">PYTHON_PATH</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">stdout</span><span class="p">)</span> <span class="n">do</span> <span class="n">io</span><span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="n">end</span><span class="p">;</span> <span class="n">end</span><span class="p">;</span>

<span class="n">python</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">import numpy as np</span>

<span class="s2">from IPython.utils import io</span>
<span class="s2">from numpy.random import rand</span>

<span class="s2">for n in [10**k for k in range(9)]:</span>
<span class="s2">    x = rand(n)</span>
<span class="s2">    y = rand(n)</span>
<span class="s2">    with io.capture_output():</span>
<span class="s2">        time = %timeit -o x.T @ y</span>
<span class="s2">    print(f&#39;n = </span><span class="si">{n:&gt;12,}</span><span class="s2">: time=</span><span class="si">{time}</span><span class="s2">&#39;)</span>

<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Python 3.8.8 (default, Feb 24 2021, 21:46:12) 
Type &#39;copyright&#39;, &#39;credits&#39; or &#39;license&#39; for more information
IPython 7.22.0 -- An enhanced Interactive Python. Type &#39;?&#39; for help.

In [1]: 
In [2]: 
In [2]: 
In [3]: 
In [4]: 
In [4]:    ...:    ...:    ...:    ...:    ...:    ...: n =            1: time=1.1 µs ± 2.39 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
n =           10: time=1.16 µs ± 12.7 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
n =          100: time=1.16 µs ± 4.07 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
n =        1,000: time=1.29 µs ± 5.4 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
n =       10,000: time=3.18 µs ± 30.3 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =      100,000: time=5.2 µs ± 517 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
n =    1,000,000: time=28.6 µs ± 2.68 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
n =   10,000,000: time=4.12 ms ± 386 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
n =  100,000,000: time=38.3 ms ± 998 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)

In [5]: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Julia-1.6">Julia 1.6<a class="anchor-link" href="#Julia-1.6"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">using</span> <span class="n">BenchmarkTools</span>
<span class="n">using</span> <span class="n">Strs</span>

<span class="n">pr</span><span class="s2">&quot;&quot;&quot;\</span><span class="si">%10s</span><span class="s2">(&quot;n&quot;) \</span><span class="si">%10s</span><span class="s2">(&quot;result&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="mi">10</span> <span class="o">.^</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">pr</span><span class="s2">&quot;\</span><span class="si">%10s</span><span class="s2">(n)&quot;</span>
    <span class="nd">@btime</span> <span class="p">(</span><span class="err">$</span><span class="n">x</span><span class="p">)</span><span class="s1">&#39; * $y</span>
<span class="n">end</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>         n     result
         1  8.555 ns (0 allocations: 0 bytes)
        10  11.754 ns (0 allocations: 0 bytes)
       100  17.275 ns (0 allocations: 0 bytes)
      1000  79.726 ns (0 allocations: 0 bytes)
     10000  1.200 μs (0 allocations: 0 bytes)
    100000  2.873 μs (0 allocations: 0 bytes)
   1000000  20.548 μs (0 allocations: 0 bytes)
  10000000  3.631 ms (0 allocations: 0 bytes)
 100000000  37.358 ms (0 allocations: 0 bytes)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

