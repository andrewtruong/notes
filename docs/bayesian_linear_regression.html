---

title: Bayesian Linear Regression


keywords: fastai
sidebar: home_sidebar

summary: "Example"
description: "Example"
nb_path: "nbs/07_concepts/bayesian_linear_regression.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/07_concepts/bayesian_linear_regression.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression">Linear Regression<a class="anchor-link" href="#Linear-Regression"> </a></h2><h3 id="Typical-framing">Typical framing<a class="anchor-link" href="#Typical-framing"> </a></h3><ol>
<li><p>$y = X\beta + \epsilon$  -- Target = data * params + error</p>
</li>
<li><p>$\epsilon_i ~ \mathcal{N}(0, \sigma^2)$  --  Error is a noise function centered on 0</p>
</li>
<li><p>$y_i ~ \mathcal{N}(\beta^Tx_i, \sigma^2$</p>
</li>
</ol>
<h3 id="Regularization">Regularization<a class="anchor-link" href="#Regularization"> </a></h3><ul>
<li><p>Added because $\hat{\beta}$ for ML tends to have high variance, so small change in $x$ results in large change in $\beta$ (bad)</p>
</li>
<li><p>$\text{LASSO: } \hat{\beta}_{L1} = \argmin_\beta[\lVert {y-X\beta}_2^2 \rVert + \lambda \lVert \beta \rVert_1]$</p>
</li>
<li><p>$\text{RIDGE: } \hat{\beta}_{L2} = \argmin_\beta[\lVert {y-X\beta}_2^2 \rVert + \lambda \lVert \beta \rVert_2^2]$</p>
</li>
</ul>

</div>
</div>
</div>But where did regularization come from?
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bayesian-Approach">Bayesian Approach<a class="anchor-link" href="#Bayesian-Approach"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-a-MAP-estimate">Create a MAP estimate<a class="anchor-link" href="#Create-a-MAP-estimate"> </a></h3>$$
\hat{\beta}_{MAP} = \argmax_\beta[P(\beta|y)] = \argmax_\beta[\frac{P(y|\beta)P(\beta)}{P(y)}] = \argmax_\beta[P(y|\beta)P(\beta)]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Rearrange-to-matrix-form">Rearrange to matrix form<a class="anchor-link" href="#Rearrange-to-matrix-form"> </a></h3><ul>
<li><p>$y_i ~ \mathcal{N}(\beta^Tx_i, \sigma^2)$</p>
</li>
<li><p>$P(y|\beta) = \prod_{i=1}^N{\frac{1}{\sigma\sqrt{2\pi}}e}$</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Choose-a-Gaussian-Prior----Get-L2-Norm">Choose a Gaussian Prior -- Get L2 Norm<a class="anchor-link" href="#Choose-a-Gaussian-Prior----Get-L2-Norm"> </a></h3><p>$\argmin_\beta[\lVert y-X\beta \rVert_2^2 + \frac{\sigma^2}{\tau^2} \lVert \beta \rVert_2^2]$</p>
<p>Substitute $\lambda = \frac{\sigma^2}{\tau^2}$:</p>
<p>$\argmin_\beta[\lVert y-X\beta \rVert_2^2 + \lambda \lVert \beta \rVert_2^2] = \hat{\beta}_{L2}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Choose-a-Laplacian-Prior----Get-L1-Norm">Choose a Laplacian Prior -- Get L1 Norm<a class="anchor-link" href="#Choose-a-Laplacian-Prior----Get-L1-Norm"> </a></h3>
</div>
</div>
</div>
</div>
 

