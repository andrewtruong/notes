---

title: Linux Servers


keywords: fastai
sidebar: home_sidebar

summary: "Recipes for Linux Servers"
description: "Recipes for Linux Servers"
nb_path: "nbs/01_linux_servers_networking/linux_servers.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_linux_servers_networking/linux_servers.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Services">Services<a class="anchor-link" href="#Services"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Keep it simple.</li>
<li><a href="https://www.linuxserver.io/">LinuxServer</a> has pre-built images that are tested and easy to deploy, so prefer these images if possible.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup-Dynamic-DNS">Setup Dynamic DNS<a class="anchor-link" href="#Setup-Dynamic-DNS"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="https://hub.docker.com/r/linuxserver/duckdns/">DuckDNS</a> is the easiest way to setup dynamic DNS AFAIK.</li>
<li>Your ISP or router manufacturer may also provide dynamic DNS service.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="DuckDNS">DuckDNS<a class="anchor-link" href="#DuckDNS"> </a></h3><ol>
<li>Create an account on <a href="http://www.duckdns.org/">DuckDNS</a></li>
<li>Create a subdomain for your services (e.g. <code>yourdomain.duckdns.org</code>)</li>
<li>Deploy the DuckDNS container and allow a few min for your IP to update</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup-Reverse-Proxy">Setup Reverse Proxy<a class="anchor-link" href="#Setup-Reverse-Proxy"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="https://github.com/jc21/nginx-proxy-manager">NGINX Proxy Manager</a> is the easiest way to setup a reverse proxy AFAIK</li>
<li><a href="https://hub.docker.com/r/linuxserver/swag">SWAG</a> is another option, but is more involved.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="NGINX-Proxy-Manager">NGINX Proxy Manager<a class="anchor-link" href="#NGINX-Proxy-Manager"> </a></h3><ol>
<li>Deploy the NGINX Proxy Manager container</li>
<li>Log in and change password</li>
<li>Create a new proxy host:<ul>
<li>Domain Names: <code>yourdomain.duckdns.org</code> or a subdomain like <code>service.yourdomain.duckdns.org</code></li>
<li>Scheme: <code>http</code> or <code>https</code> depending on your service</li>
<li>Forward Hostname / IP: The URL of your service, or local IP, e.g. <code>192.168.1.101</code></li>
<li>Forward Port: The Port of your service, e.g. <code>8080</code></li>
<li>Enable <code>Block Common Exploits</code></li>
</ul>
</li>
<li>Add an SSL Certificate<ul>
<li>Request a new SSL Certificate with Let's Encrypt</li>
<li>Enable <code>Force SSL</code> and <code>HTTP/2 Support</code></li>
</ul>
</li>
<li>Add access list if you want to restrict access to certain users</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup-Multiple-Services-and-Load-Balancer-(naive)">Setup Multiple Services and Load Balancer (naive)<a class="anchor-link" href="#Setup-Multiple-Services-and-Load-Balancer-(naive)"> </a></h2><ul>
<li>Expose services on one port</li>
<li>Create load balancer with the <code>internal:external</code> port mapping</li>
<li>Or use Kubernetes</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compose">Compose<a class="anchor-link" href="#Compose"> </a></h3><p><code>docker-compose.yml</code></p>
<div class="highlight"><pre><span></span><span class="nt">version</span><span class="p">:</span> <span class="s">&quot;3&quot;</span>
<span class="nt">services</span><span class="p">:</span>
    <span class="nt">app1</span><span class="p">:</span>
        <span class="c1"># config here</span>
        <span class="nt">expose</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;9000&quot;</span>
    <span class="nt">app2</span><span class="p">:</span>
        <span class="c1"># config here</span>
        <span class="nt">expose</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;9000&quot;</span>
    <span class="nt">app3</span><span class="p">:</span>
        <span class="c1"># config here</span>
        <span class="nt">expose</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;9000&quot;</span>
    <span class="nt">app4</span><span class="p">:</span>
        <span class="c1"># config here</span>
        <span class="nt">expose</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;9000&quot;</span>
    <span class="nt">load_balancer</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:1.19.2-alpine</span>
        <span class="nt">volumes</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./nginx.conf:/etc/nginx/nginx.conf:ro</span>
        <span class="nt">ports</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="s">&quot;9000:9000&quot;</span>
        <span class="nt">depends_on</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">app1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">app2</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">app3</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">app4</span>
</pre></div>
<p><code>nginx.conf</code></p>

<pre><code>conf
user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;

    keepalive_timeout  65;

    upstream app {
        server app1:9000;
        server app2:9000;
        server app3:9000;
        server app4:9000;
    }

    server {
        listen       9000;
        listen  [::]:9000;
        server_name  localhost;

         ignore_invalid_headers off;
         client_max_body_size 0;
         proxy_buffering off;

        location / {
            proxy_set_header Host $http_host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            proxy_connect_timeout 300;
            proxy_http_version 1.1;
            proxy_set_header Connection "";
            chunked_transfer_encoding off;

            proxy_pass http://app;
        }
    }
}</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Check-server-performance">Check server performance<a class="anchor-link" href="#Check-server-performance"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="NetData">NetData<a class="anchor-link" href="#NetData"> </a></h3><ul>
<li><a href="https://learn.netdata.cloud/docs/agent/packaging/installer">https://learn.netdata.cloud/docs/agent/packaging/installer</a></li>
<li><a href="https://learn.netdata.cloud/docs/agent/web/server">https://learn.netdata.cloud/docs/agent/web/server</a><ul>
<li>Dashboard at <a href="https://127.0.0.1:19999">https://127.0.0.1:19999</a></li>
<li>Management console at <a href="https://10.1.1.1:19998">https://10.1.1.1:19998</a></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span>bash &lt;<span class="o">(</span>curl -Ss https://my-netdata.io/kickstart.sh<span class="o">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grafana/Kibana">Grafana/Kibana<a class="anchor-link" href="#Grafana/Kibana"> </a></h3><ul>
<li>For small scale deployment, this is not worth the hassle.  NetData gives you most of what you need out of the box.</li>
<li>See Grafana deploys for more</li>
</ul>

</div>
</div>
</div>
</div>
 

